<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bible</title>
<style>
body{font-family:'Nanum Gothic',sans-serif;margin:0;padding:0;background:#f8f8f8}
.topbar{position:sticky;top:0;background:#fff;padding:12px;border-bottom:1px solid #ddd;z-index:10;text-align:center}
select{padding:6px 10px;margin:0 5px}
.verse{padding:20px;border-bottom:1px solid #e5e5e5;background:#fff;margin-bottom:8px}
.ref{font-weight:bold;margin-bottom:10px}
.he{font-size:28px;direction:rtl;text-align:right;margin:10px 0}
.kor{margin:10px 0;font-size:16px}
</style>
</head>
<body>

<div class="topbar">
  성경 
  <select id="bookSel">
    <option value="genesis">창세기</option>
  </select>
  장 
  <select id="chapterSel"></select>
</div>

<div id="verses"></div>

<script>
const versesEl = document.getElementById("verses");
const chapterSel = document.getElementById("chapterSel");

for(let i=1;i<=50;i++){
  const opt=document.createElement("option");
  opt.value=i;
  opt.textContent=i+"장";
  chapterSel.appendChild(opt);
}

chapterSel.addEventListener("change",()=>{
  loadChapter("genesis",chapterSel.value);
});

function escapeHTML(str){
  return str.replace(/[&<>"']/g,function(m){
    return({"&":"&amp;","<":"&lt;",">":"&gt;",""":"&quot;","'":"&#39;"}[m]);
  });
}

async function loadChapter(book,chapter){
  versesEl.innerHTML="";
  const res=await fetch(`data/${book}/${chapter}.json`);
  const data=await res.json();
  const versesObj=data.verses||{};
  const keys=Object.keys(versesObj).sort((a,b)=>Number(a)-Number(b));

  keys.forEach(v=>{
    const item=versesObj[v];
    const ref=item.reference||"";
    const verseText=item.verseText||"";
    const korLine=item.kor2 ?? item.kor ?? "";

    const sec=document.createElement("section");
    sec.className="verse";
    sec.innerHTML=`
      <div class="ref">${escapeHTML(ref)}</div>
      <h1 class="he">${escapeHTML(verseText)}</h1>
      <div class="kor">${escapeHTML(korLine)}</div>
    `;
    versesEl.appendChild(sec);
  });
}

loadChapter("genesis",1);
</script>

</body>
</html>
