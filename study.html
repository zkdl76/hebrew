<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Genesis Study - TTS Version</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* ì „ì²´ ë°°ê²½ ë° ì¤‘ì•™ ì •ë ¬ */
        body {
            margin: 0;
            background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
            font-family: 'Segoe UI', sans-serif;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
        }

        /* ğŸ  í™ˆ ë²„íŠ¼ (ìƒë‹¨ ì™¼ìª½) */
        #homeBtn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: 0.3s;
        }
        #homeBtn:hover { background: rgba(255, 255, 255, 0.3); }

        /* ğŸƒ í•™ìŠµ ì¹´ë“œ */
        #card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 25px;
            padding: 50px;
            width: 90%;
            max-width: 600px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            backdrop-filter: blur(10px);
        }

        #chapterTitle { font-size: 18px; color: #aaa; margin-bottom: 10px; }
        
        /* íˆë¸Œë¦¬ì–´ ë‹¨ì–´ */
        #hebrew {
            font-size: 100px;
            direction: rtl;
            margin-bottom: 30px;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(255,255,255,0.2);
        }

        .info { font-size: 26px; margin: 12px 0; color: #e0e0e0; }
        
        /* ë²„íŠ¼ ì˜ì—­ */
        #nav { margin-top: 40px; }
        button {
            font-size: 20px;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }
        button:active { transform: scale(0.95); }
        button:disabled { opacity: 0.2; cursor: default; }

        #backBtn { background: #555; color: white; }
        #nextBtn { background: #4CAF50; color: white; }
        
        /* ğŸ”Š ìŒì„± ì œì–´ ë²„íŠ¼ */
        #audioControl {
            margin-top: 20px;
            font-size: 14px;
            color: #888;
            cursor: pointer;
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <!-- í™ˆìœ¼ë¡œ ì´ë™ ë²„íŠ¼ -->
    <a href="rootmain.html" id="homeBtn">ğŸ  ë©”ì¸ ë©”ë‰´</a>

    <div id="card">
        <div id="chapterTitle"></div>
        <div id="hebrew"></div>
        <div class="info" id="root"></div>
        <div class="info" id="meaning"></div>
        <div class="info" id="gloss"></div>
        
        <div id="nav">
            <button id="backBtn">â—€ ì´ì „</button>
            <button id="nextBtn">ë‹¤ìŒ â–¶</button>
        </div>

        <div id="audioControl" onclick="toggleAudio()">ğŸ”Š ìŒì„± ìë™ ì¬ìƒ ì¤‘ (í´ë¦­ ì‹œ ì¤‘ì§€)</div>
    </div>

    <script src="data.js"></script>
    <script>
        const params = new URLSearchParams(location.search);
        let ch = params.get("ch") || "1";
        const words = bibleData[ch] || [];
        let index = 0;

        const hebrewEl = document.getElementById("hebrew");
        const rootEl = document.getElementById("root");
        const meaningEl = document.getElementById("meaning");
        const glossEl = document.getElementById("gloss");
        const backBtn = document.getElementById("backBtn");
        const nextBtn = document.getElementById("nextBtn");
        const titleEl = document.getElementById("chapterTitle");
        const audioControl = document.getElementById("audioControl");

        titleEl.textContent = `Genesis ${ch} í•™ìŠµ`;

        let isAudioOn = true;

        // ğŸ”Š TTS ì¬ìƒ í•¨ìˆ˜
        function speakHebrew(text) {
            window.speechSynthesis.cancel(); // ì´ì „ ìŒì„± ì¦‰ì‹œ ì¤‘ë‹¨
            
            if (!isAudioOn || !text) return;

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'he-IL';
            utterance.rate = 0.7; // ëŠë¦° ì†ë„

            // ë¬´í•œ ë°˜ë³µ ì„¤ì •
            utterance.onend = () => {
                if (isAudioOn) window.speechSynthesis.speak(utterance);
            };

            window.speechSynthesis.speak(utterance);
        }

        // ğŸ”‡ ìŒì„± ON/OFF í† ê¸€
        function toggleAudio() {
            isAudioOn = !isAudioOn;
            if (!isAudioOn) {
                window.speechSynthesis.cancel();
                audioControl.textContent = "ğŸ”‡ ìŒì„± ì¼ì‹œ ì¤‘ì§€ë¨ (í´ë¦­ ì‹œ ì¬ìƒ)";
            } else {
                audioControl.textContent = "ğŸ”Š ìŒì„± ìë™ ì¬ìƒ ì¤‘ (í´ë¦­ ì‹œ ì¤‘ì§€)";
                speakHebrew(words[index].form);
            }
        }

        function render() {
            if (words.length === 0) {
                hebrewEl.textContent = "ë°ì´í„° ì—†ìŒ";
                return;
            }

            const w = words[index];
            hebrewEl.textContent = w.form;
            rootEl.textContent = "ì–´ê·¼: " + w.root;
            meaningEl.textContent = "ëœ»: " + w.meaning.join(", ");
            glossEl.textContent = "gloss: " + w.gloss;

            backBtn.disabled = (index === 0);
            nextBtn.disabled = (index === words.length - 1);

            // ë‹¨ì–´ ë³€ê²½ ì‹œ ìŒì„± ì¬ìƒ
            speakHebrew(w.form);
        }

        backBtn.onclick = () => { if (index > 0) { index--; render(); } };
        nextBtn.onclick = () => { if (index < words.length - 1) { index++; render(); } };

        // ì´ˆê¸° ì‹¤í–‰
        window.onload = () => {
            render();
            // ë¸Œë¼ìš°ì € ì •ì±…ìƒ ì²« í´ë¦­ ì „ê¹Œì§€ ì†Œë¦¬ê°€ ì•ˆ ë‚  ìˆ˜ ìˆìŒì„ ì•Œë¦¼
            console.log("í™”ë©´ì„ í´ë¦­í•˜ë©´ ìŒì„± ì¬ìƒì´ ì‹œì‘ë©ë‹ˆë‹¤.");
        };

        // í˜ì´ì§€ ì´ë™ ì‹œ ìŒì„± ì™„ì „ ì¤‘ë‹¨
        window.onbeforeunload = () => { window.speechSynthesis.cancel(); };
    </script>
</body>
</html>
